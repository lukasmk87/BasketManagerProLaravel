###################################################################################
# BasketManager Pro - Production Environment Configuration
###################################################################################
# This file contains production-ready environment variables.
# Copy this file to .env on your production server and fill in the actual values.
#
# IMPORTANT: Never commit the actual .env file to version control!
###################################################################################

###################################################################################
# Application Configuration
###################################################################################
APP_NAME="BasketManager Pro"
APP_ENV=production
APP_KEY=                              # Generate with: php artisan key:generate
APP_DEBUG=false                        # MUST be false in production!
APP_URL=https://basketmanager-pro.de  # Your production URL

APP_LOCALE=de
APP_FALLBACK_LOCALE=de
APP_FAKER_LOCALE=de_DE

APP_MAINTENANCE_DRIVER=file
PHP_CLI_SERVER_WORKERS=4
BCRYPT_ROUNDS=12

###################################################################################
# Logging Configuration
###################################################################################
LOG_CHANNEL=stack
LOG_STACK=daily                       # Use daily rotation for production
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=info                        # Use 'info' or 'warning' for production

###################################################################################
# Database Configuration
###################################################################################
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=basketmanager_pro
DB_USERNAME=basketmanager_user
DB_PASSWORD=                          # Strong password required!

# Database Connection Pool
DB_POOL_MIN=2
DB_POOL_MAX=10

###################################################################################
# Session & Cookie Configuration (HTTPS Required)
###################################################################################
SESSION_DRIVER=redis                  # Use Redis for production (faster than database)
SESSION_LIFETIME=120
SESSION_ENCRYPT=true                  # Encrypt session data
SESSION_PATH=/
SESSION_DOMAIN=.basketmanager-pro.de  # Include subdomain dot for wildcard
SESSION_SECURE_COOKIE=true            # HTTPS required!
SESSION_SAME_SITE=lax
SESSION_HTTP_ONLY=true

###################################################################################
# Cache Configuration
###################################################################################
CACHE_STORE=redis                     # Redis recommended for production
CACHE_PREFIX=basketmanager_cache_

###################################################################################
# Queue Configuration
###################################################################################
QUEUE_CONNECTION=redis                # Redis recommended for production
QUEUE_FAILED_DRIVER=database

###################################################################################
# Redis Configuration
###################################################################################
REDIS_CLIENT=phpredis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=                       # Redis password (recommended)
REDIS_PORT=6379
REDIS_DB=0
REDIS_CACHE_DB=1
REDIS_QUEUE_DB=2

###################################################################################
# Mail Configuration
###################################################################################
MAIL_MAILER=smtp                      # Use SMTP for production
MAIL_SCHEME=tls
MAIL_HOST=smtp.example.com           # Your SMTP server
MAIL_PORT=587
MAIL_USERNAME=                       # SMTP username
MAIL_PASSWORD=                       # SMTP password
MAIL_FROM_ADDRESS="noreply@basketmanager-pro.de"
MAIL_FROM_NAME="${APP_NAME}"
MAIL_ENCRYPTION=tls

###################################################################################
# Stripe Configuration (LIVE MODE - Production)
###################################################################################
# ⚠️ WARNING: Use LIVE keys only on production!
STRIPE_KEY=pk_live_...                              # Stripe LIVE publishable key
STRIPE_SECRET=sk_live_...                           # Stripe LIVE secret key
STRIPE_WEBHOOK_SECRET=whsec_...                    # Webhook signing secret
STRIPE_WEBHOOK_SECRET_CLUB=whsec_...               # Club subscription webhook (optional)

# Stripe Product IDs (set after creating products in Stripe Dashboard)
STRIPE_STANDARD_CLUB_PRODUCT_ID=
STRIPE_STANDARD_CLUB_PRICE_MONTHLY=
STRIPE_STANDARD_CLUB_PRICE_YEARLY=
STRIPE_PREMIUM_CLUB_PRODUCT_ID=
STRIPE_PREMIUM_CLUB_PRICE_MONTHLY=
STRIPE_PREMIUM_CLUB_PRICE_YEARLY=
STRIPE_ENTERPRISE_CLUB_PRODUCT_ID=
STRIPE_ENTERPRISE_CLUB_PRICE_MONTHLY=
STRIPE_ENTERPRISE_CLUB_PRICE_YEARLY=

# Vite Stripe Configuration (Frontend)
VITE_STRIPE_KEY="${STRIPE_KEY}"

###################################################################################
# Broadcasting Configuration (Pusher/WebSockets)
###################################################################################
BROADCAST_CONNECTION=pusher
PUSHER_APP_ID=
PUSHER_APP_KEY=
PUSHER_APP_SECRET=
PUSHER_APP_CLUSTER=eu                # Use 'eu' for Europe
PUSHER_SCHEME=https
PUSHER_HOST=
PUSHER_PORT=443

VITE_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
VITE_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"

###################################################################################
# Filesystem & Storage (S3/AWS)
###################################################################################
FILESYSTEM_DISK=s3                    # Use S3 for production
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=eu-central-1      # Frankfurt region
AWS_BUCKET=basketmanager-pro-storage
AWS_URL=
AWS_USE_PATH_STYLE_ENDPOINT=false

###################################################################################
# Feature Flags Configuration
###################################################################################
# Enable/Disable major features for gradual rollout
FEATURE_CLUB_SUBSCRIPTIONS_ENABLED=true
FEATURE_CLUB_SUBSCRIPTIONS_CHECKOUT_ENABLED=true
FEATURE_CLUB_SUBSCRIPTIONS_BILLING_PORTAL_ENABLED=true
FEATURE_CLUB_SUBSCRIPTIONS_PLAN_SWAP_ENABLED=true
FEATURE_CLUB_SUBSCRIPTIONS_ANALYTICS_ENABLED=false  # Beta feature
FEATURE_CLUB_SUBSCRIPTIONS_NOTIFICATIONS_ENABLED=true

# Rollout configuration
FEATURE_ROLLOUT_METHOD=percentage                   # percentage, whitelist, gradual
FEATURE_ROLLOUT_WHITELIST_TENANTS=                  # Comma-separated tenant IDs
FEATURE_CLUB_SUBSCRIPTIONS_ROLLOUT=100              # 0-100 percentage
FEATURE_CLUB_SUBSCRIPTIONS_CHECKOUT_ROLLOUT=100
FEATURE_CLUB_SUBSCRIPTIONS_BILLING_PORTAL_ROLLOUT=100
FEATURE_CLUB_SUBSCRIPTIONS_PLAN_SWAP_ROLLOUT=100
FEATURE_CLUB_SUBSCRIPTIONS_ANALYTICS_ROLLOUT=0      # Beta: 0% rollout

# Feature flag persistence
FEATURE_FLAG_PERSISTENCE_ENABLED=true
FEATURE_FLAG_CACHE_TTL=3600
FEATURE_FLAG_LOG_CHANGES=true
FEATURE_BETA_OPT_IN_REQUIRED=true
FEATURE_FLAG_DEVELOPMENT_MODE=false                  # MUST be false in production!

###################################################################################
# Monitoring & Error Tracking (Sentry)
###################################################################################
SENTRY_LARAVEL_DSN=                                  # Sentry DSN for error tracking
SENTRY_TRACES_SAMPLE_RATE=0.1                        # 10% performance monitoring

###################################################################################
# Analytics & Metrics
###################################################################################
GOOGLE_ANALYTICS_ID=
MIXPANEL_TOKEN=

###################################################################################
# Security Configuration
###################################################################################
# CORS Configuration
CORS_ALLOWED_ORIGINS=https://basketmanager-pro.de,https://app.basketmanager-pro.de

# Rate Limiting
THROTTLE_REQUESTS_PER_MINUTE=60
THROTTLE_LOGIN_ATTEMPTS=5

# Content Security Policy
CSP_ENABLED=true

###################################################################################
# Multi-Tenancy Configuration
###################################################################################
TENANT_CACHE_TTL=3600                               # Cache tenant data for 1 hour
TENANT_STRICT_MODE=true                             # Enforce tenant isolation

###################################################################################
# Backup Configuration
###################################################################################
BACKUP_DISK=s3                                       # Store backups on S3
BACKUP_SCHEDULE=daily                                # daily, weekly, monthly
BACKUP_RETENTION_DAYS=30

###################################################################################
# Queue Worker Configuration
###################################################################################
QUEUE_WORKER_TIMEOUT=60
QUEUE_WORKER_SLEEP=3
QUEUE_WORKER_TRIES=3

###################################################################################
# Telescope (Application Monitoring) - Disable in Production
###################################################################################
TELESCOPE_ENABLED=false                              # Set to false in production!

###################################################################################
# Horizon (Queue Dashboard) - Production Configuration
###################################################################################
HORIZON_ENABLED=true
HORIZON_DASHBOARD_ENABLED=true
HORIZON_AUTH=true                                    # Require authentication

###################################################################################
# Vite Configuration (Frontend)
###################################################################################
VITE_APP_NAME="${APP_NAME}"
VITE_APP_ENV="${APP_ENV}"
VITE_APP_URL="${APP_URL}"

###################################################################################
# Production Checklist
###################################################################################
# Before going live, ensure:
# ✓ APP_DEBUG=false
# ✓ APP_ENV=production
# ✓ Strong APP_KEY generated
# ✓ HTTPS enabled (APP_URL, SESSION_SECURE_COOKIE=true)
# ✓ Stripe LIVE keys configured
# ✓ Database credentials secure
# ✓ Redis password set
# ✓ SMTP configured
# ✓ Sentry DSN configured
# ✓ Backups enabled
# ✓ Queue workers running (php artisan queue:work --daemon)
# ✓ Scheduler running (cron job: * * * * * php artisan schedule:run)
# ✓ SSL certificate valid
# ✓ Firewall rules configured
# ✓ .env file permissions (chmod 600)
