# =============================================================================
# DEDICATED SERVER / VPS ENVIRONMENT CONFIGURATION
# =============================================================================
# This template is optimized for dedicated servers, VPS, or cloud hosting
# (e.g., AWS, DigitalOcean, Hetzner, Linode) where Redis is available.
#
# Usage:
# 1. Copy this file to .env: cp .env.dedicated-server.example .env
# 2. Install Redis: sudo apt-get install redis-server
# 3. Start Redis: sudo systemctl start redis && sudo systemctl enable redis
# 4. Update database credentials and other settings below
# 5. Run: php artisan key:generate
# 6. Run: php artisan config:clear
# 7. Run: php artisan migrate
#
# Features:
# - Uses Redis for cache (high performance)
# - Uses Redis for sessions (fast, distributed)
# - Uses Redis for queue (reliable job processing)
# - Optimized for production workloads
# - Supports horizontal scaling
# =============================================================================

APP_NAME="BasketManager Pro"
APP_ENV=production
APP_KEY=
APP_DEBUG=false
APP_URL=https://your-domain.com
APP_TIMEZONE=Europe/Berlin

APP_LOCALE=de
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=de_DE

APP_MAINTENANCE_DRIVER=file

BCRYPT_ROUNDS=12

LOG_CHANNEL=stack
LOG_STACK=single,daily
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=warning

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=basketmanager_pro
DB_USERNAME=basketmanager_user
DB_PASSWORD=your_secure_password_here

# Database connection pooling (for high traffic)
DB_POOL_MIN=2
DB_POOL_MAX=20

# =============================================================================
# REDIS CONFIGURATION (Primary caching and session store)
# =============================================================================
REDIS_CLIENT=phpredis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379

# Redis database separation
REDIS_CACHE_DB=1
REDIS_QUEUE_DB=2
REDIS_SESSION_DB=3

# Redis cluster configuration (if using Redis Cluster)
# REDIS_CLUSTER=true
# REDIS_CLUSTER_NODES="127.0.0.1:7000,127.0.0.1:7001,127.0.0.1:7002"

# =============================================================================
# CACHE CONFIGURATION (Redis-based for optimal performance)
# =============================================================================
CACHE_STORE=redis
CACHE_PREFIX=bmp_
CACHE_TTL=3600

# =============================================================================
# SESSION CONFIGURATION (Redis-based for distributed sessions)
# =============================================================================
SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null

# IMPORTANT: For HTTPS (production)
SESSION_SECURE_COOKIE=true
SESSION_SAME_SITE=lax
SESSION_HTTP_ONLY=true
SESSION_PARTITIONED_COOKIE=false

# =============================================================================
# QUEUE CONFIGURATION (Redis-based for reliable job processing)
# =============================================================================
QUEUE_CONNECTION=redis

# Queue worker configuration (supervisor recommended)
# See supervisor configuration example in deployment docs

# =============================================================================
# BROADCASTING (Pusher for real-time features)
# =============================================================================
BROADCAST_CONNECTION=pusher

# Pusher Configuration (for live game scoring and real-time updates)
PUSHER_APP_ID=your-app-id
PUSHER_APP_KEY=your-app-key
PUSHER_APP_SECRET=your-app-secret
PUSHER_APP_CLUSTER=eu
PUSHER_SCHEME=https

# Alternative: Use Laravel WebSockets or Soketi for self-hosted WebSocket server
# BROADCAST_CONNECTION=reverb
# REVERB_APP_ID=your-app-id
# REVERB_APP_KEY=your-app-key
# REVERB_APP_SECRET=your-app-secret
# REVERB_HOST=your-websocket-domain.com
# REVERB_PORT=443
# REVERB_SCHEME=https

# =============================================================================
# FILESYSTEM
# =============================================================================
FILESYSTEM_DISK=s3

# Local filesystem fallback
# FILESYSTEM_DISK=local

# =============================================================================
# MAIL CONFIGURATION
# =============================================================================
MAIL_MAILER=smtp
MAIL_HOST=smtp.mailgun.org
MAIL_PORT=587
MAIL_USERNAME=your-mailgun-username
MAIL_PASSWORD=your-mailgun-password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS="noreply@your-domain.com"
MAIL_FROM_NAME="${APP_NAME}"

# Alternative: Use AWS SES, Postmark, or other providers
# MAIL_MAILER=ses
# AWS_SES_REGION=eu-central-1

# =============================================================================
# STRIPE CONFIGURATION (for subscriptions and payments)
# =============================================================================
# Use LIVE keys for production
STRIPE_KEY=pk_live_...
STRIPE_SECRET=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_WEBHOOK_SECRET_CLUB=whsec_...

# Vite Stripe Configuration (Frontend)
VITE_STRIPE_KEY="${STRIPE_KEY}"

# =============================================================================
# MULTI-TENANT CONFIGURATION
# =============================================================================
TENANT_IDENTIFICATION=domain  # Options: domain, subdomain, slug
TENANT_DOMAIN_SUFFIX=.your-main-domain.com  # For subdomain mode

# Row Level Security (RLS)
TENANT_RLS_ENABLED=true

# Initial Tenant Setup (for first installation)
# These values are used by: php artisan tenant:initialize --force
# or: php artisan db:seed --class=InitialTenantSeeder
TENANT_NAME="BasketManager Pro"
TENANT_BILLING_EMAIL=admin@your-domain.com
TENANT_SUBSCRIPTION_TIER=professional  # Options: free, basic, professional, enterprise
TENANT_COUNTRY=DE
TENANT_CURRENCY=EUR
TENANT_TRIAL_DAYS=30  # Optional: Add trial period

# Optional Branding
TENANT_PRIMARY_COLOR=#4F46E5
TENANT_LOGO_URL=
TENANT_SUPPORT_EMAIL=support@your-domain.com
TENANT_PHONE=

# =============================================================================
# SECURITY SETTINGS
# =============================================================================
# Force HTTPS in production
FORCE_HTTPS=true

# Content Security Policy
CSP_ENABLED=true

# Rate Limiting (Redis-backed for distributed rate limiting)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60

# Security headers
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================
# Query caching (uses Redis)
QUERY_CACHE_ENABLED=true
QUERY_CACHE_TTL=3600

# OpCache settings (in php.ini)
# opcache.enable=1
# opcache.memory_consumption=256
# opcache.interned_strings_buffer=16
# opcache.max_accelerated_files=20000
# opcache.validate_timestamps=0

# =============================================================================
# AWS S3 CONFIGURATION (for file storage)
# =============================================================================
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
AWS_DEFAULT_REGION=eu-central-1
AWS_BUCKET=basketmanager-pro-uploads
AWS_USE_PATH_STYLE_ENDPOINT=false
AWS_URL=https://your-bucket.s3.eu-central-1.amazonaws.com

# CloudFront CDN (optional)
# AWS_CLOUDFRONT_URL=https://your-distribution.cloudfront.net

# =============================================================================
# MONITORING & ERROR TRACKING
# =============================================================================
# Sentry for error tracking
SENTRY_LARAVEL_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_ENVIRONMENT=production

# Application Performance Monitoring
# NEW_RELIC_LICENSE_KEY=your-license-key
# NEW_RELIC_APP_NAME="BasketManager Pro"

# =============================================================================
# DATABASE PERFORMANCE MONITORING
# =============================================================================
SLOW_QUERY_LOGGING=true
SLOW_QUERY_THRESHOLD=1000  # milliseconds

# =============================================================================
# TELESCOPE & HORIZON (Development/Staging only)
# =============================================================================
# TELESCOPE_ENABLED=false
# HORIZON_ENABLED=true

# =============================================================================
# VITE CONFIGURATION
# =============================================================================
VITE_APP_NAME="${APP_NAME}"
VITE_PUSHER_APP_KEY="${PUSHER_APP_KEY}"
VITE_PUSHER_APP_CLUSTER="${PUSHER_APP_CLUSTER}"

# =============================================================================
# SCOUT SEARCH ENGINE (Optional - for full-text search)
# =============================================================================
SCOUT_DRIVER=meilisearch
MEILISEARCH_HOST=http://127.0.0.1:7700
MEILISEARCH_KEY=your-master-key

# Alternative: Algolia
# SCOUT_DRIVER=algolia
# ALGOLIA_APP_ID=your-app-id
# ALGOLIA_SECRET=your-api-key

# =============================================================================
# IMPORTANT PRODUCTION DEPLOYMENT NOTES
# =============================================================================
# 1. REDIS INSTALLATION:
#    Ubuntu/Debian:
#      sudo apt-get update
#      sudo apt-get install redis-server
#      sudo systemctl start redis
#      sudo systemctl enable redis
#
#    CentOS/RHEL:
#      sudo yum install redis
#      sudo systemctl start redis
#      sudo systemctl enable redis
#
#    Test: redis-cli ping (should return PONG)
#
# 2. SUPERVISOR SETUP FOR QUEUE WORKERS:
#    Create /etc/supervisor/conf.d/basketmanager-worker.conf:
#
#    [program:basketmanager-worker]
#    process_name=%(program_name)s_%(process_num)02d
#    command=php /var/www/basketmanager-pro/artisan queue:work redis --sleep=3 --tries=3 --max-time=3600
#    autostart=true
#    autorestart=true
#    stopasgroup=true
#    killasgroup=true
#    user=www-data
#    numprocs=4
#    redirect_stderr=true
#    stdout_logfile=/var/www/basketmanager-pro/storage/logs/worker.log
#    stopwaitsecs=3600
#
#    Then: sudo supervisorctl reread && sudo supervisorctl update && sudo supervisorctl start basketmanager-worker:*
#
# 3. CRON JOB SETUP:
#    Add to crontab (sudo crontab -e):
#    * * * * * cd /var/www/basketmanager-pro && php artisan schedule:run >> /dev/null 2>&1
#
# 4. NGINX CONFIGURATION:
#    See PRODUCTION_DEPLOYMENT.md for complete nginx setup
#
# 5. OPTIMIZATION COMMANDS:
#    php artisan config:cache
#    php artisan route:cache
#    php artisan view:cache
#    php artisan event:cache
#    php artisan optimize
#
# 6. SECURITY:
#    - Set proper file permissions (755 for directories, 644 for files)
#    - Disable directory listing in nginx/apache
#    - Configure firewall (UFW/iptables)
#    - Enable fail2ban for SSH protection
#    - Regular security updates
#
# 7. MONITORING:
#    - Set up server monitoring (Datadog, New Relic, or similar)
#    - Configure log rotation
#    - Set up automated backups
#    - Monitor Redis memory usage
#
# =============================================================================
