import{r as d,q as p,s as m,k as A,d as c,o as u,e as C,a as t,l as y,t as O,m as S,G as D,_ as I,x as w}from"./app-CoGxkfVc.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"text-center"},M={class:"text-sm text-red-700 mb-2"},N=["height","width"],P={key:2,class:"absolute inset-0 flex items-center justify-center bg-gray-50 rounded-lg"},T={__name:"StatsChart",props:{type:{type:String,default:"bar",validator:a=>["bar","line","doughnut","pie","radar","polarArea"].includes(a)},data:{type:Object,required:!0},options:{type:Object,default:()=>({})},height:{type:Number,default:300},width:{type:Number,default:null},responsive:{type:Boolean,default:!0},maintainAspectRatio:{type:Boolean,default:!1}},setup(a,{expose:k}){const r=a,B=d(null),s=d(null),h=d(null),i=d(!0),o=d(null),R=p(()=>{const e={responsive:r.responsive,maintainAspectRatio:r.maintainAspectRatio,plugins:{legend:{position:"bottom",labels:{padding:20,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"white",bodyColor:"white",borderColor:"rgba(0, 0, 0, 0.1)",borderWidth:1,cornerRadius:6,displayColors:!0}}};switch(r.type){case"bar":case"line":return{...e,scales:{x:{grid:{display:!0,drawBorder:!1,color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}},y:{beginAtZero:!0,grid:{display:!0,drawBorder:!1,color:"rgba(0, 0, 0, 0.05)"},ticks:{font:{size:11}}}}};case"radar":return{...e,scales:{r:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)"},angleLines:{color:"rgba(0, 0, 0, 0.1)"},pointLabels:{font:{size:11}}}}};case"doughnut":case"pie":return{...e,cutout:r.type==="doughnut"?"50%":"0%",plugins:{...e.plugins,legend:{...e.plugins.legend,position:"right"}}};default:return e}}),b=p(()=>({...R.value,...r.options})),z=p(()=>({type:r.type,data:r.data,options:b.value})),E=async(e=10,n=100)=>{for(let l=0;l<e;l++){if(h.value)return h.value;await new Promise(f=>setTimeout(f,n)),await w()}throw new Error("Canvas-Element nicht verfügbar")},v=async()=>{try{i.value=!0,o.value=null;const{Chart:e,registerables:n}=await I(async()=>{const{Chart:f,registerables:j}=await import("./chart-CUJbImKC.js");return{Chart:f,registerables:j}},[]);e.register(...n),s.value&&s.value.destroy(),await w();const l=await E();if(!l.isConnected&&(await w(),!l.isConnected))throw new Error("Canvas-Element nicht im DOM verfügbar");s.value=new e(l,z.value),i.value=!1}catch(e){console.error("Fehler beim Initialisieren des Charts:",e),o.value="Chart konnte nicht geladen werden",i.value=!1}},g=()=>{s.value&&r.data&&(s.value.data=r.data,s.value.options=b.value,s.value.update("active"))},x=async()=>{await v()};return m(()=>r.data,()=>{s.value&&g()},{deep:!0}),m(()=>r.options,()=>{s.value&&g()},{deep:!0}),m(()=>r.type,async()=>{await v()}),A(async()=>{await v()}),k({reloadChart:x,updateChart:g,chartInstance:s}),(e,n)=>(u(),c("div",{ref_key:"chartRef",ref:B,class:"relative"},[i.value?(u(),c("div",{key:0,class:"flex items-center justify-center",style:y({height:a.height+"px"})},n[0]||(n[0]=[t("div",{class:"flex flex-col items-center space-y-3"},[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"}),t("span",{class:"text-sm text-gray-600"},"Chart wird geladen...")],-1)]),4)):o.value?(u(),c("div",{key:1,class:"flex items-center justify-center bg-red-50 rounded-lg",style:y({height:a.height+"px"})},[t("div",V,[n[1]||(n[1]=t("svg",{class:"mx-auto h-12 w-12 text-red-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L12.732 4.5c-.77-.833-2.694-.833-3.464 0L1.352 16.5C.582 18.333 1.544 20 3.084 20z"})],-1)),t("p",M,O(o.value),1),t("button",{onClick:x,class:"text-sm text-red-600 hover:text-red-800 underline"}," Erneut versuchen ")])],4)):C("",!0),t("div",{class:"relative",style:y({height:a.height+"px",width:a.width?a.width+"px":"100%"})},[S(t("canvas",{ref_key:"canvasRef",ref:h,height:a.height,width:a.width,class:"max-w-full"},null,8,N),[[D,!i.value&&!o.value]])],4),!i.value&&!o.value&&(!a.data||!a.data.datasets||a.data.datasets.length===0)?(u(),c("div",P,n[2]||(n[2]=[t("div",{class:"text-center"},[t("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),t("p",{class:"text-sm text-gray-600"},"Keine Daten verfügbar")],-1)]))):C("",!0)],512))}},F=L(T,[["__scopeId","data-v-bb7f1154"]]);export{F as S};
