import{u as j,r as x,s as G,x as C,c as K,o as a,w as c,b as u,g as o,a as e,d as r,e as f,y as R,f as m,m as U,p as W,F as D,h as V,t as i,n as w}from"./app-CoGxkfVc.js";import{_ as H}from"./DialogModal-C0QVC45F.js";import{_ as A}from"./InputLabel-C_RcxF_l.js";import{_ as J}from"./InputError-o9U-HAWP.js";import{_ as Z}from"./TextInput-BJ5pfwEC.js";import{_ as F}from"./PrimaryButton-CwuCmxQ7.js";import{_ as y}from"./SecondaryButton-Bp3bKgLC.js";import"./Modal-CLjYKrsc.js";const q={class:"space-y-6"},O={class:"bg-gray-50 p-4 rounded-lg"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},X={class:"flex items-center space-x-4"},Y={key:0,class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ee={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},se={key:0,class:"space-y-4"},te={class:"grid gap-4"},ne={class:"flex items-center justify-between"},le={class:"flex-1"},ie={class:"flex items-center space-x-4"},oe={class:"flex-shrink-0"},ae=["src","alt"],re={class:"flex-1 min-w-0"},de={class:"flex items-center space-x-2"},ue={class:"text-lg font-medium text-gray-900"},me={class:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-2 text-sm text-gray-500"},ce={key:0,class:"mt-2 text-sm text-gray-600"},fe={class:"flex flex-col space-y-2"},ve={key:0,class:"mt-4 pt-4 border-t border-gray-200"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"space-y-2"},be={class:"text-sm space-y-1"},xe={class:"space-y-2"},he={class:"text-sm space-y-1"},_e={key:0},ke={key:1},we={key:0,class:"mt-4"},ye={class:"space-y-1"},Ne={key:1,class:"text-center py-8"},Be={key:2,class:"bg-red-50 border border-red-200 rounded-md p-4"},ze={class:"flex"},Se={class:"ml-3"},Ce={class:"mt-2 text-sm text-red-700"},Te={__name:"PlayerSearchModal",props:{show:Boolean},emits:["close","playerFound"],setup(N,{emit:L}){const $=N,B=L,n=j({licenseNumber:"",database:"both"}),_=x(null),v=x([]),g=x(!1),b=x(null),p=x("");G(()=>$.show,l=>{l&&C(()=>_.value?.focus())});const z=async()=>{if(n.licenseNumber){n.processing=!0,p.value="",g.value=!1;try{let l=[];(n.database==="both"||n.database==="dbb")&&l.push(axios.get(`/federation/dbb/player?license_number=${n.licenseNumber}`)),(n.database==="both"||n.database==="fiba")&&l.push(axios.get(`/federation/fiba/player/search?license_number=${n.licenseNumber}`));const s=await Promise.allSettled(l),t=[];s.forEach((d,E)=>{if(d.status==="fulfilled"&&d.value.data.success){const S=d.value.data.player;S.source=n.database==="both"?E===0?"dbb":"fiba":n.database,t.push(S)}}),v.value=t,g.value=!0,t.length===0&&(p.value="Spieler mit dieser Lizenznummer nicht gefunden.")}catch(l){console.error("Player search failed:",l),p.value="Fehler bei der Verbindung zu den Verbandsdatenbanken. Bitte versuchen Sie es später erneut.",v.value=[],g.value=!0}finally{n.processing=!1}}},M=()=>{n.reset(),v.value=[],g.value=!1,b.value=null,p.value="",C(()=>_.value?.focus())},P=l=>{B("playerFound",l),k()},T=l=>{b.value=b.value===l.id?null:l.id},k=()=>{n.reset(),n.clearErrors(),v.value=[],g.value=!1,b.value=null,p.value="",B("close")},h=l=>l?new Date(l).toLocaleDateString("de-DE"):"N/A",I=l=>({active:"Aktiv",suspended:"Gesperrt",inactive:"Inaktiv",transfer:"Wechsel"})[l]||l;return(l,s)=>(a(),K(H,{show:N.show,onClose:k,"max-width":"4xl"},{title:c(()=>s[2]||(s[2]=[o(" Spielersuche in Verbands-Datenbanken ",-1)])),content:c(()=>[e("div",q,[e("div",O,[e("div",Q,[e("div",null,[u(A,{for:"license_number",value:"Lizenznummer"}),u(Z,{id:"license_number",ref_key:"licenseNumberInput",ref:_,modelValue:m(n).licenseNumber,"onUpdate:modelValue":s[0]||(s[0]=t=>m(n).licenseNumber=t),type:"text",class:"mt-1 block w-full",placeholder:"z.B. 12345678",onKeyup:R(z,["enter"]),maxlength:"12"},null,8,["modelValue"]),u(J,{message:m(n).errors.licenseNumber,class:"mt-2"},null,8,["message"])]),e("div",null,[u(A,{for:"search_database",value:"Datenbank"}),U(e("select",{id:"search_database","onUpdate:modelValue":s[1]||(s[1]=t=>m(n).database=t),class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm"},s[3]||(s[3]=[e("option",{value:"both"},"Beide (DBB & FIBA)",-1),e("option",{value:"dbb"},"DBB (Deutscher Basketball Bund)",-1),e("option",{value:"fiba"},"FIBA Europe",-1)]),512),[[W,m(n).database]])])]),e("div",X,[u(F,{onClick:z,disabled:m(n).processing||!m(n).licenseNumber},{default:c(()=>[m(n).processing?(a(),r("svg",Y,s[4]||(s[4]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(a(),r("svg",ee,s[5]||(s[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"},null,-1)]))),s[6]||(s[6]=o(" Spieler suchen ",-1))]),_:1,__:[6]},8,["disabled"]),u(y,{onClick:M},{default:c(()=>s[7]||(s[7]=[o(" Zurücksetzen ",-1)])),_:1,__:[7]})])]),v.value.length>0?(a(),r("div",se,[s[25]||(s[25]=e("h4",{class:"text-lg font-medium text-gray-900"},"Suchergebnisse",-1)),e("div",te,[(a(!0),r(D,null,V(v.value,t=>(a(),r("div",{key:t.id,class:"border rounded-lg p-4 hover:bg-gray-50"},[e("div",ne,[e("div",le,[e("div",ie,[e("div",oe,[e("img",{class:"h-12 w-12 rounded-full",src:t.avatar||"/default-avatar.png",alt:t.fullName},null,8,ae)]),e("div",re,[e("div",de,[e("h3",ue,i(t.firstName)+" "+i(t.lastName),1),e("span",{class:w(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",t.source==="dbb"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"])},i(t.source.toUpperCase()),3)]),e("div",me,[e("div",null,[s[8]||(s[8]=e("span",{class:"font-medium"},"Lizenznr:",-1)),o(" "+i(t.licenseNumber),1)]),e("div",null,[s[9]||(s[9]=e("span",{class:"font-medium"},"Geboren:",-1)),o(" "+i(h(t.birthDate)),1)]),e("div",null,[s[10]||(s[10]=e("span",{class:"font-medium"},"Position:",-1)),o(" "+i(t.position||"N/A"),1)]),e("div",null,[s[11]||(s[11]=e("span",{class:"font-medium"},"Status:",-1)),e("span",{class:w([t.status==="active"?"text-green-600":t.status==="suspended"?"text-red-600":"text-yellow-600"])},i(I(t.status)),3)])]),t.currentTeam?(a(),r("div",ce,[s[12]||(s[12]=e("span",{class:"font-medium"},"Aktuelles Team:",-1)),o(" "+i(t.currentTeam),1)])):f("",!0)])])]),e("div",fe,[u(F,{onClick:d=>P(t),size:"sm"},{default:c(()=>s[13]||(s[13]=[o(" Auswählen ",-1)])),_:2,__:[13]},1032,["onClick"]),u(y,{onClick:d=>T(t),size:"sm"},{default:c(()=>s[14]||(s[14]=[o(" Details ",-1)])),_:2,__:[14]},1032,["onClick"])])]),b.value===t.id?(a(),r("div",ve,[e("div",pe,[e("div",ge,[s[19]||(s[19]=e("h5",{class:"font-medium text-gray-900"},"Allgemeine Informationen",-1)),e("div",be,[e("p",null,[s[15]||(s[15]=e("span",{class:"font-medium"},"Nationalität:",-1)),o(" "+i(t.nationality||"N/A"),1)]),e("p",null,[s[16]||(s[16]=e("span",{class:"font-medium"},"Größe:",-1)),o(" "+i(t.height||"N/A")+" cm",1)]),e("p",null,[s[17]||(s[17]=e("span",{class:"font-medium"},"Gewicht:",-1)),o(" "+i(t.weight||"N/A")+" kg",1)]),e("p",null,[s[18]||(s[18]=e("span",{class:"font-medium"},"Registriert seit:",-1)),o(" "+i(h(t.registeredSince)),1)])])]),e("div",xe,[s[23]||(s[23]=e("h5",{class:"font-medium text-gray-900"},"Berechtigung & Status",-1)),e("div",he,[e("p",null,[s[20]||(s[20]=e("span",{class:"font-medium"},"Spielberechtigt:",-1)),e("span",{class:w(t.eligible?"text-green-600":"text-red-600")},i(t.eligible?"Ja":"Nein"),3)]),t.transferWindow?(a(),r("p",_e,[s[21]||(s[21]=e("span",{class:"font-medium"},"Transfer-Fenster:",-1)),o(" "+i(t.transferWindow),1)])):f("",!0),t.suspensionReason?(a(),r("p",ke,[s[22]||(s[22]=e("span",{class:"font-medium"},"Sperrgrund:",-1)),o(" "+i(t.suspensionReason),1)])):f("",!0)])])]),t.recentTeams&&t.recentTeams.length>0?(a(),r("div",we,[s[24]||(s[24]=e("h5",{class:"font-medium text-gray-900 mb-2"},"Vereinshistorie",-1)),e("div",ye,[(a(!0),r(D,null,V(t.recentTeams,d=>(a(),r("div",{key:d.id,class:"text-sm text-gray-600 flex justify-between"},[e("span",null,i(d.name),1),e("span",null,i(h(d.from))+" - "+i(d.to?h(d.to):"heute"),1)]))),128))])])):f("",!0)])):f("",!0)]))),128))])])):f("",!0),g.value&&v.value.length===0&&!m(n).processing?(a(),r("div",Ne,s[26]||(s[26]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Keine Spieler gefunden",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Kein Spieler mit dieser Lizenznummer in der ausgewählten Datenbank gefunden.",-1)]))):f("",!0),p.value?(a(),r("div",Be,[e("div",ze,[s[28]||(s[28]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",Se,[s[27]||(s[27]=e("h3",{class:"text-sm font-medium text-red-800"},"Fehler bei der Spielersuche",-1)),e("div",Ce,i(p.value),1)])])])):f("",!0)])]),footer:c(()=>[u(y,{onClick:k},{default:c(()=>s[29]||(s[29]=[o(" Schließen ",-1)])),_:1,__:[29]})]),_:1},8,["show"]))}};export{Te as default};
