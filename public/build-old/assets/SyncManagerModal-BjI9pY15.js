import{r as d,k as T,c as W,o as r,w as m,a as e,b as p,g as y,d as i,t as n,e as c,n as f,m as u,p as U,v as g,l as K,F as N,h as P}from"./app-CoGxkfVc.js";import{_ as R}from"./DialogModal-C0QVC45F.js";import{_ as F}from"./InputLabel-C_RcxF_l.js";import{_ as Z}from"./PrimaryButton-CwuCmxQ7.js";import{_ as B}from"./SecondaryButton-Bp3bKgLC.js";import"./Modal-CLjYKrsc.js";const q={class:"space-y-6"},G={class:"bg-gray-50 p-4 rounded-lg"},J={class:"flex items-center justify-between mb-4"},Q={class:"text-sm text-gray-500"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={class:"border rounded-lg p-3"},ee={class:"flex items-center justify-between mb-2"},te={class:"text-sm text-gray-600"},se={class:"border rounded-lg p-3"},le={class:"flex items-center justify-between mb-2"},ne={class:"text-sm text-gray-600"},oe={class:"space-y-4"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={key:0,class:"bg-gray-50 p-4 rounded-lg"},ie={class:"grid grid-cols-2 md:grid-cols-3 gap-3"},de={class:"flex items-center"},ue={class:"flex items-center"},ce={class:"flex items-center"},ge={class:"flex items-center"},ve={class:"flex items-center"},me={class:"flex items-center"},pe={class:"bg-gray-50 p-4 rounded-lg"},ye={class:"space-y-3"},fe={class:"flex items-center"},xe={class:"flex items-center"},be={class:"flex items-center"},he={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},ke={class:"flex items-center justify-between mb-2"},we={class:"text-sm text-blue-700"},Se={class:"w-full bg-blue-200 rounded-full h-2 mb-2"},_e={class:"text-sm text-blue-700"},De={key:1,class:"space-y-4"},Be={class:"flex"},Ce={class:"flex-shrink-0"},Ve={key:0,class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},Ae={key:1,class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},Me={class:"ml-3"},ze={key:0},Ie={key:1},Ue={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ne={class:"space-y-1"},Pe={key:0,class:"text-red-500"},Fe={key:0,class:"text-sm text-red-600"},Le={class:"space-y-4"},Oe={class:"flex items-center justify-between"},je={class:"space-y-2"},$e={class:"flex items-center justify-between"},Ee={class:"flex-1"},He={class:"flex items-center space-x-2"},Te={class:"text-sm font-medium text-gray-900"},We={class:"text-sm text-gray-500"},Ke={class:"mt-1 text-sm text-gray-600"},Re={key:0,class:"text-center py-6"},Ze={class:"flex justify-between"},qe={key:0,class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ge={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},st={__name:"SyncManagerModal",props:{show:Boolean},emits:["close","syncCompleted"],setup(L,{emit:O}){const C=O,b=d(null),h=d("idle"),k=d("idle"),S=d({players:1248,teams:89,leagues:12}),_=d({players:2156,competitions:8,clubs:145}),l=d({type:"incremental",federation:"both",areas:["players","teams"],validateData:!0,backupBeforeSync:!0,sendNotification:!0}),v=d(!1),x=d(0),D=d(""),o=d(null),w=d([]);T(()=>{j()});const j=()=>{b.value=new Date(Date.now()-7200*1e3).toISOString(),w.value=[{id:1,type:"Inkrementell",federation:"DBB",status:"success",recordsProcessed:245,duration:125e3,createdAt:new Date(Date.now()-7200*1e3).toISOString()},{id:2,type:"Vollständig",federation:"FIBA",status:"error",recordsProcessed:1024,duration:31e4,createdAt:new Date(Date.now()-1440*60*1e3).toISOString()},{id:3,type:"Selektiv",federation:"Beide",status:"success",recordsProcessed:89,duration:45e3,createdAt:new Date(Date.now()-4320*60*1e3).toISOString()}]},$=async()=>{v.value=!0,x.value=0,o.value=null;try{const a=["Verbindung zu APIs herstellen...","Daten abrufen...","Validierung läuft...","Daten importieren...","Cache aktualisieren...","Synchronisation abschließen..."];for(let t=0;t<a.length;t++)D.value=a[t],x.value=(t+1)/a.length*100,await new Promise(s=>setTimeout(s,1e3));o.value={success:!0,duration:6e3,recordsProcessed:423,recordsUpdated:156,recordsCreated:67,recordsSkipped:12,errors:[]},w.value.unshift({id:Date.now(),type:l.value.type==="incremental"?"Inkrementell":l.value.type==="full"?"Vollständig":"Selektiv",federation:l.value.federation==="both"?"Beide":l.value.federation.toUpperCase(),status:"success",recordsProcessed:o.value.recordsProcessed,duration:o.value.duration,createdAt:new Date().toISOString()}),b.value=new Date().toISOString(),C("syncCompleted",o.value)}catch(a){console.error("Sync failed:",a),o.value={success:!1,duration:3e3,recordsProcessed:89,recordsUpdated:0,recordsCreated:0,errors:[{message:"API-Verbindung zu DBB fehlgeschlagen",code:"CONN_001"},{message:"Ungültige Datenstruktur erkannt",code:"DATA_002"}]}}finally{v.value=!1,D.value="",x.value=0}},E=async()=>{},H=a=>{console.log("View sync details:",a)},V=()=>{v.value||(o.value=null,C("close"))},A=a=>({idle:"Bereit",running:"Läuft",success:"Erfolgreich",error:"Fehler"})[a]||a,M=a=>a?new Date(a).toLocaleString("de-DE"):"N/A",z=a=>{if(!a)return"0s";const t=Math.floor(a/1e3),s=Math.floor(t/60);return s>0?`${s}m ${t%60}s`:`${t}s`};return(a,t)=>(r(),W(R,{show:L.show,onClose:V,"max-width":"4xl"},{title:m(()=>t[11]||(t[11]=[y(" Federation Daten-Synchronisation ",-1)])),content:m(()=>[e("div",q,[e("div",G,[e("div",J,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium text-gray-900"},"Synchronisations-Status",-1)),e("div",Q," Letzte Sync: "+n(b.value?M(b.value):"Noch nie"),1)]),e("div",X,[e("div",Y,[e("div",ee,[t[13]||(t[13]=e("h4",{class:"font-medium text-gray-900"},"DBB Synchronisation",-1)),e("span",{class:f(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",h.value==="success"?"bg-green-100 text-green-800":h.value==="running"?"bg-blue-100 text-blue-800":h.value==="error"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"])},n(A(h.value)),3)]),e("div",te,[e("p",null,"Spieler: "+n(S.value.players||0),1),e("p",null,"Teams: "+n(S.value.teams||0),1),e("p",null,"Ligen: "+n(S.value.leagues||0),1)])]),e("div",se,[e("div",le,[t[14]||(t[14]=e("h4",{class:"font-medium text-gray-900"},"FIBA Synchronisation",-1)),e("span",{class:f(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",k.value==="success"?"bg-green-100 text-green-800":k.value==="running"?"bg-blue-100 text-blue-800":k.value==="error"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"])},n(A(k.value)),3)]),e("div",ne,[e("p",null,"Spieler: "+n(_.value.players||0),1),e("p",null,"Wettkämpfe: "+n(_.value.competitions||0),1),e("p",null,"Clubs: "+n(_.value.clubs||0),1)])])])]),e("div",oe,[t[28]||(t[28]=e("h3",{class:"text-lg font-medium text-gray-900"},"Synchronisations-Optionen",-1)),e("div",re,[e("div",null,[p(F,{for:"sync_type",value:"Synchronisations-Typ"}),u(e("select",{id:"sync_type","onUpdate:modelValue":t[0]||(t[0]=s=>l.value.type=s),class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm"},t[15]||(t[15]=[e("option",{value:"incremental"},"Inkrementell (nur Änderungen)",-1),e("option",{value:"full"},"Vollständig (alle Daten)",-1),e("option",{value:"selective"},"Selektiv (ausgewählte Bereiche)",-1)]),512),[[U,l.value.type]])]),e("div",null,[p(F,{for:"federation_select",value:"Verband"}),u(e("select",{id:"federation_select","onUpdate:modelValue":t[1]||(t[1]=s=>l.value.federation=s),class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm"},t[16]||(t[16]=[e("option",{value:"both"},"Beide (DBB & FIBA)",-1),e("option",{value:"dbb"},"Nur DBB",-1),e("option",{value:"fiba"},"Nur FIBA",-1)]),512),[[U,l.value.federation]])])]),l.value.type==="selective"?(r(),i("div",ae,[t[23]||(t[23]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Zu synchronisierende Bereiche",-1)),e("div",ie,[e("label",de,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>l.value.areas=s),value:"players",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.areas]]),t[17]||(t[17]=e("span",{class:"ml-2 text-sm text-gray-700"},"Spielerdaten",-1))]),e("label",ue,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=s=>l.value.areas=s),value:"teams",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.areas]]),t[18]||(t[18]=e("span",{class:"ml-2 text-sm text-gray-700"},"Teams",-1))]),e("label",ce,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.areas=s),value:"leagues",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.areas]]),t[19]||(t[19]=e("span",{class:"ml-2 text-sm text-gray-700"},"Ligen",-1))]),e("label",ge,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=s=>l.value.areas=s),value:"competitions",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.areas]]),t[20]||(t[20]=e("span",{class:"ml-2 text-sm text-gray-700"},"Wettkämpfe",-1))]),e("label",ve,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>l.value.areas=s),value:"officials",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.areas]]),t[21]||(t[21]=e("span",{class:"ml-2 text-sm text-gray-700"},"Schiedsrichter",-1))]),e("label",me,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=s=>l.value.areas=s),value:"schedules",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.areas]]),t[22]||(t[22]=e("span",{class:"ml-2 text-sm text-gray-700"},"Spielpläne",-1))])])])):c("",!0),e("div",pe,[t[27]||(t[27]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Erweiterte Optionen",-1)),e("div",ye,[e("label",fe,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=s=>l.value.validateData=s),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.validateData]]),t[24]||(t[24]=e("span",{class:"ml-2 text-sm text-gray-700"},"Daten vor Import validieren",-1))]),e("label",xe,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=s=>l.value.backupBeforeSync=s),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.backupBeforeSync]]),t[25]||(t[25]=e("span",{class:"ml-2 text-sm text-gray-700"},"Backup vor Synchronisation erstellen",-1))]),e("label",be,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[10]||(t[10]=s=>l.value.sendNotification=s),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[g,l.value.sendNotification]]),t[26]||(t[26]=e("span",{class:"ml-2 text-sm text-gray-700"},"E-Mail-Benachrichtigung nach Abschluss",-1))])])])]),v.value?(r(),i("div",he,[e("div",ke,[t[29]||(t[29]=e("h4",{class:"font-medium text-blue-900"},"Synchronisation läuft...",-1)),e("span",we,n(Math.round(x.value))+"%",1)]),e("div",Se,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:K({width:x.value+"%"})},null,4)]),e("div",_e,n(D.value),1)])):c("",!0),o.value&&!v.value?(r(),i("div",De,[t[33]||(t[33]=e("h4",{class:"text-lg font-medium text-gray-900"},"Synchronisations-Ergebnis",-1)),e("div",{class:f(["border rounded-lg p-4",o.value.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50"])},[e("div",Be,[e("div",Ce,[o.value.success?(r(),i("svg",Ve,t[30]||(t[30]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):(r(),i("svg",Ae,t[31]||(t[31]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)])))]),e("div",Me,[e("h5",{class:f(["text-sm font-medium",o.value.success?"text-green-800":"text-red-800"])},n(o.value.success?"Synchronisation erfolgreich":"Synchronisation fehlgeschlagen"),3),e("div",{class:f(["mt-2 text-sm",o.value.success?"text-green-700":"text-red-700"])},[e("p",null,"Dauer: "+n(z(o.value.duration)),1),e("p",null,"Verarbeitete Datensätze: "+n(o.value.recordsProcessed||0),1),e("p",null,"Aktualisiert: "+n(o.value.recordsUpdated||0),1),e("p",null,"Neu erstellt: "+n(o.value.recordsCreated||0),1),o.value.recordsSkipped?(r(),i("p",ze,"Übersprungen: "+n(o.value.recordsSkipped),1)):c("",!0),o.value.errors&&o.value.errors.length>0?(r(),i("p",Ie," Fehler: "+n(o.value.errors.length),1)):c("",!0)],2)])])],2),o.value.errors&&o.value.errors.length>0?(r(),i("div",Ue,[t[32]||(t[32]=e("h5",{class:"font-medium text-red-800 mb-2"},"Fehlerdetails",-1)),e("div",Ne,[(r(!0),i(N,null,P(o.value.errors.slice(0,5),(s,I)=>(r(),i("div",{key:I,class:"text-sm text-red-700"},[y(n(s.message)+" ",1),s.code?(r(),i("span",Pe,"(Code: "+n(s.code)+")",1)):c("",!0)]))),128)),o.value.errors.length>5?(r(),i("div",Fe," ... und "+n(o.value.errors.length-5)+" weitere Fehler ",1)):c("",!0)])])):c("",!0)])):c("",!0),e("div",Le,[e("div",Oe,[t[35]||(t[35]=e("h4",{class:"text-lg font-medium text-gray-900"},"Letzte Synchronisationen",-1)),p(B,{onClick:E,size:"sm"},{default:m(()=>t[34]||(t[34]=[y(" Aktualisieren ",-1)])),_:1,__:[34]})]),e("div",je,[(r(!0),i(N,null,P(w.value,s=>(r(),i("div",{key:s.id,class:"border rounded-lg p-3 hover:bg-gray-50"},[e("div",$e,[e("div",Ee,[e("div",He,[e("span",{class:f(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",s.status==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},n(s.status==="success"?"Erfolgreich":"Fehlgeschlagen"),3),e("span",Te,n(s.type),1),e("span",We,n(s.federation),1)]),e("div",Ke,n(M(s.createdAt))+" - "+n(s.recordsProcessed||0)+" Datensätze - "+n(z(s.duration)),1)]),p(B,{onClick:I=>H(s),size:"sm"},{default:m(()=>t[36]||(t[36]=[y(" Details ",-1)])),_:2,__:[36]},1032,["onClick"])])]))),128))]),w.value.length===0?(r(),i("div",Re,t[37]||(t[37]=[e("svg",{class:"mx-auto h-10 w-10 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Keine Synchronisations-Historie",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Bisher wurden noch keine Synchronisationen durchgeführt.",-1)]))):c("",!0)])])]),footer:m(()=>[e("div",Ze,[p(B,{onClick:V},{default:m(()=>t[38]||(t[38]=[y(" Schließen ",-1)])),_:1,__:[38]}),p(Z,{onClick:$,disabled:v.value||l.value.type==="selective"&&l.value.areas.length===0,class:"bg-blue-600 hover:bg-blue-700"},{default:m(()=>[v.value?(r(),i("svg",qe,t[39]||(t[39]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),i("svg",Ge,t[40]||(t[40]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))),y(" "+n(v.value?"Synchronisiert...":"Synchronisation starten"),1)]),_:1},8,["disabled"])])]),_:1},8,["show"]))}};export{st as default};
