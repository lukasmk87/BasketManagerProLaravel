import{d as r,o as n,a as e,r as y,k as T,x as A,c as I,w as x,b as l,f as d,t as o,F as h,h as v,n as p,A as R,g as f,e as g,j as w}from"./app-CoGxkfVc.js";import{_ as N}from"./AppLayout-Drc7lzl4.js";import{Chart as k,registerables as P}from"./chart-CUJbImKC.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as V}from"./ShieldExclamationIcon-WHmaSqzf.js";import{r as z}from"./ExclamationTriangleIcon-AgrX6-ml.js";import{r as G}from"./ClockIcon-B2eYc2jM.js";import{r as M,b as F,a as L}from"./MagnifyingGlassIcon-DS8ECMZV.js";import{r as O}from"./DocumentArrowDownIcon-D8nzkgIE.js";function U(i,c){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.34 15.84c-.688-.06-1.386-.09-2.09-.09H7.5a4.5 4.5 0 1 1 0-9h.75c.704 0 1.402-.03 2.09-.09m0 9.18c.253.962.584 1.892.985 2.783.247.55.06 1.21-.463 1.511l-.657.38c-.551.318-1.26.117-1.527-.461a20.845 20.845 0 0 1-1.44-4.282m3.102.069a18.03 18.03 0 0 1-.59-4.59c0-1.586.205-3.124.59-4.59m0 9.18a23.848 23.848 0 0 1 8.835 2.535M10.34 6.66a23.847 23.847 0 0 0 8.835-2.535m0 0A23.74 23.74 0 0 0 18.795 3m.38 1.125a23.91 23.91 0 0 1 1.014 5.395m-1.014 8.855c-.118.38-.245.754-.38 1.125m.38-1.125a23.91 23.91 0 0 0 1.014-5.395m0-3.46c.495.413.811 1.035.811 1.73 0 .695-.316 1.317-.811 1.73m0-3.46a24.347 24.347 0 0 1 0 3.46"})])}k.register(...P);const q={class:"flex justify-between items-center"},H={class:"flex gap-4"},Z=["disabled"],J={class:"py-6"},K={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Q={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-6 mb-8"},W={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},X={class:"p-6"},Y={class:"flex items-center"},ee={class:"flex-shrink-0"},te={class:"ml-4"},se={class:"text-2xl font-semibold text-gray-900"},oe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ie={class:"p-6"},ne={class:"flex items-center"},re={class:"flex-shrink-0"},le={class:"ml-4"},de={class:"text-2xl font-semibold text-red-600"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ce={class:"p-6"},me={class:"flex items-center"},_e={class:"flex-shrink-0"},ge={class:"ml-4"},ue={class:"text-2xl font-semibold text-orange-600"},xe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},he={class:"p-6"},ve={class:"flex items-center"},pe={class:"flex-shrink-0"},fe={class:"ml-4"},be={class:"text-2xl font-semibold text-yellow-600"},ye={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},we={class:"p-6"},ke={class:"flex items-center"},Ce={class:"flex-shrink-0"},Ee={class:"ml-4"},De={class:"text-2xl font-semibold text-purple-600"},$e={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Se={class:"p-6"},je={class:"flex items-center"},Te={class:"flex-shrink-0"},Ae={class:"ml-4"},Ie={class:"text-2xl font-semibold text-indigo-600"},Re={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Ne={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Pe={class:"p-6"},Be={class:"h-64"},Ve={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ze={class:"p-6"},Ge={class:"space-y-3"},Me={class:"flex items-center"},Fe={class:"text-sm text-gray-700"},Le={class:"text-sm font-semibold text-gray-900"},Oe={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ue={class:"lg:col-span-2 bg-white overflow-hidden shadow-sm sm:rounded-lg"},qe={class:"p-6"},He={class:"flex justify-between items-center mb-4"},Ze={class:"space-y-3"},Je=["onClick"],Ke={class:"flex items-center space-x-3"},Qe={class:"text-lg"},We={class:"text-sm font-medium text-gray-900"},Xe={class:"text-xs text-gray-500"},Ye={class:"text-xs text-gray-400"},et={class:"flex items-center space-x-2"},tt={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},st={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},ot={key:0,class:"text-center py-4"},it={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},nt={class:"p-6"},rt={class:"space-y-3"},lt={class:"text-sm font-mono text-gray-900"},dt={class:"text-sm font-semibold text-gray-600"},at={key:0,class:"text-center py-4"},ct={__name:"Dashboard",props:{recentEvents:Array,metrics:Object,trends:Array,eventTypeDistribution:Object,topSourceIPs:Array},setup(i){const c=i,m=y(!1),b=y(null);let u=null;const C=()=>{m.value=!0,w.reload({only:["recentEvents","metrics","trends","eventTypeDistribution","topSourceIPs"]}).then(()=>{m.value=!1})},E=()=>{alert("Report generation feature coming soon!")},D=a=>{w.visit(`/security/events/${a}`)},$=a=>a.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),S=a=>({authentication_failure:"bg-red-400",authorization_violation:"bg-orange-400",emergency_access_misuse:"bg-yellow-400",emergency_access_anomaly:"bg-yellow-500",gdpr_violation:"bg-purple-400",gdpr_compliance_violation:"bg-purple-500",suspicious_activity:"bg-gray-400",brute_force_attempt:"bg-red-500",data_export_unusual:"bg-blue-400",rate_limit_exceeded:"bg-green-400"})[a]||"bg-gray-400",j=()=>{u&&u.destroy();const a=b.value.getContext("2d");u=new k(a,{type:"line",data:{labels:c.trends.map(t=>t.label),datasets:[{label:"Total Events",data:c.trends.map(t=>t.total_events),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"Critical Events",data:c.trends.map(t=>t.critical_events),borderColor:"rgb(239, 68, 68)",backgroundColor:"rgba(239, 68, 68, 0.1)",tension:.4},{label:"Emergency Events",data:c.trends.map(t=>t.emergency_events),borderColor:"rgb(245, 158, 11)",backgroundColor:"rgba(245, 158, 11, 0.1)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}}})};return T(()=>{A(()=>{j()})}),(a,t)=>(n(),I(N,{title:"Security Dashboard"},{header:x(()=>[e("div",q,[t[2]||(t[2]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Security Dashboard ",-1)),e("div",H,[e("button",{onClick:E,class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300 disabled:opacity-25 transition ease-in-out duration-150"},[l(d(O),{class:"w-4 h-4 mr-2"}),t[0]||(t[0]=f(" Generate Report ",-1))]),e("button",{onClick:C,disabled:m.value,class:"inline-flex items-center px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150"},[l(d(L),{class:p(["w-4 h-4 mr-2",{"animate-spin":m.value}])},null,8,["class"]),t[1]||(t[1]=f(" Refresh ",-1))],8,Z)])])]),default:x(()=>[e("div",J,[e("div",K,[e("div",Q,[e("div",W,[e("div",X,[e("div",Y,[e("div",ee,[l(d(V),{class:"h-8 w-8 text-blue-600"})]),e("div",te,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-gray-500"},"Today's Events",-1)),e("p",se,o(i.metrics.total_events_today),1)])])])]),e("div",oe,[e("div",ie,[e("div",ne,[e("div",re,[l(d(z),{class:"h-8 w-8 text-red-600"})]),e("div",le,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-500"},"Critical Events",-1)),e("p",de,o(i.metrics.critical_events_today),1)])])])]),e("div",ae,[e("div",ce,[e("div",me,[e("div",_e,[l(d(G),{class:"h-8 w-8 text-orange-600"})]),e("div",ge,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-gray-500"},"Unresolved",-1)),e("p",ue,o(i.metrics.unresolved_events),1)])])])]),e("div",xe,[e("div",he,[e("div",ve,[e("div",pe,[l(d(U),{class:"h-8 w-8 text-yellow-600"})]),e("div",fe,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-gray-500"},"Emergency",-1)),e("p",be,o(i.metrics.emergency_related_events_today),1)])])])]),e("div",ye,[e("div",we,[e("div",ke,[e("div",Ce,[l(d(M),{class:"h-8 w-8 text-purple-600"})]),e("div",Ee,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-gray-500"},"GDPR Events",-1)),e("p",De,o(i.metrics.gdpr_related_events_today),1)])])])]),e("div",$e,[e("div",Se,[e("div",je,[e("div",Te,[l(d(F),{class:"h-8 w-8 text-indigo-600"})]),e("div",Ae,[t[8]||(t[8]=e("p",{class:"text-sm font-medium text-gray-500"},"Needs Investigation",-1)),e("p",Ie,o(i.metrics.events_requiring_investigation),1)])])])])]),e("div",Re,[e("div",Ne,[e("div",Pe,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Security Events Trend (Last 7 Days)",-1)),e("div",Be,[e("canvas",{ref_key:"trendsChart",ref:b},null,512)])])]),e("div",Ve,[e("div",ze,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Event Type Distribution",-1)),e("div",Ge,[(n(!0),r(h,null,v(i.eventTypeDistribution,(s,_)=>(n(),r("div",{key:_,class:"flex items-center justify-between"},[e("div",Me,[e("div",{class:p(["w-3 h-3 rounded-full mr-3",S(_)])},null,2),e("span",Fe,o($(_)),1)]),e("span",Le,o(s),1)]))),128))])])])]),e("div",Oe,[e("div",Ue,[e("div",qe,[e("div",He,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Recent Security Events",-1)),l(d(R),{href:"/security/events",class:"text-blue-600 hover:text-blue-800 text-sm font-medium"},{default:x(()=>t[11]||(t[11]=[f(" View All ",-1)])),_:1,__:[11]})]),e("div",Ze,[(n(!0),r(h,null,v(i.recentEvents,s=>(n(),r("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:_=>D(s.id)},[e("div",Ke,[e("span",Qe,o(s.severity_icon),1),e("div",null,[e("p",We,o(s.event_id),1),e("p",Xe,o(s.description),1),e("p",Ye,o(s.time_since_occurred),1)])]),e("div",et,[e("span",{class:p(`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-${s.severity_color}-100 text-${s.severity_color}-800`)},o(s.severity),3),s.is_emergency_related?(n(),r("span",tt," Emergency ")):g("",!0),s.is_gdpr_related?(n(),r("span",st," GDPR ")):g("",!0)])],8,Je))),128)),i.recentEvents.length===0?(n(),r("div",ot,t[13]||(t[13]=[e("p",{class:"text-gray-500"},"No recent security events",-1)]))):g("",!0)])])]),e("div",it,[e("div",nt,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Top Source IPs (24h)",-1)),e("div",rt,[(n(!0),r(h,null,v(i.topSourceIPs,s=>(n(),r("div",{key:s.ip,class:"flex items-center justify-between"},[e("div",null,[e("span",lt,o(s.ip),1)]),e("span",dt,o(s.count)+" events",1)]))),128)),i.topSourceIPs.length===0?(n(),r("div",at,t[14]||(t[14]=[e("p",{class:"text-gray-500"},"No events in last 24 hours",-1)]))):g("",!0)])])])])])])]),_:1}))}},bt=B(ct,[["__scopeId","data-v-c4f85fd5"]]);export{bt as default};
